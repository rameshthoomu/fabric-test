#
# SPDX-License-Identifier: Apache-2.0
#

trigger:
- master
- release-1.*

variables:
  GOROOT: 'usr/bin/go'
  GOPATH: '/home/ubuntu/azure/1/go'
  PATH: '$(GOROOT)/bin:$(GOPATH)/bin:$(GOPATH)/binaries/bin:/bin:/usr/bin:/sbin:/usr/sbin:/usr/local/bin:/usr/local/sbin'
  
jobs:
- job: VerifyBuild
  pool:
    vmImage: 'ubuntu-16.04'
  steps:
  - script: |
      apt-get update
      apt-get install libtool gcc make haveged python-minimal git -y

      sudo curl -L "https://github.com/docker/compose/releases/download/1.24.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
      sudo chmod +x /usr/local/bin/docker-compose

      wget https://dl.google.com/go/go1.12.5.linux-amd64.tar.gz
      tar -xzf go1.12.5.linux-amd64.tar.gz
      sudo mv go /usr/bin
    displayName: Install Deps
  - script: mkdir -p '$(GOPATH)/src/github.com/hyperledger'
    displayName: Create Org Directory
  - checkout: self
    path: 'go/src/github.com/hyperledger/fabric-test'
    displayName: Checkout Fabric Code
  - script: make clean
